<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign Up</title>
    
    <style>
      html {
        background: none;
      }
      
      body {
        margin: 0 auto;
        padding: 0;
        text-align: left;
      }
      
      header {
        background: #63AF00;
        width: 100%;
        height: 78px;
        margin-bottom: 16px;
      }
      
      header img {
        margin: 0px 0 0 30.9px;
        width: 155.48px;
      }
      
      .basf-signUp {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        font-family: "Helvetica Neue Light";
        border: 2px solid seashell;
        height: auto;
        margin-bottom: 38px;
      }

      .basf-signUp #api {
        margin: 0 200px;
      }
      
      .basf-signUp #api .verifying-modal {
        display: none;
      }

      .basf-signUp #api .intro > p {
        font-family: "Helvetica Neue Light";
        font-size: 36px !important;
        font-weight: 300 !important;
        margin: 70px 0 31px 0;
        color: #333333;
        letter-spacing: normal;
        line-height: 44px;
      }

      .basf-signUp #attributeVerification .attr ul {
        margin: 0;
        padding: 0;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
      }

      .basf-signUp #attributeVerification .attr ul li {
        list-style: none;
        margin-top: 32px;
        flex: 0 0 45%;
      }
      
      .basf-signUp #attributeVerification .attr ul li:first-child,
      .basf-signUp #attributeVerification .attr ul li:nth-child(2) {
        margin-top: 0;
      }
      
      .basf-signUp #attributeVerification .attr ul li .attrEntry a {
        display: none;
      }
      
      .basf-signUp #attributeVerification .attr ul li:nth-child(5),
      .basf-signUp #attributeVerification .attr ul li:nth-child(8),
      .basf-signUp #attributeVerification .attr ul li:nth-child(12) {
        flex: 0 0 100%;
      }
      
      .basf-signUp #attributeVerification .attr ul li:nth-child(10),
      .basf-signUp #attributeVerification .attr ul li:nth-child(11) {
        flex: 0 0 20%;
      }

      .basf-signUp #attributeVerification .attr ul li .attrEntry label {
        font-size: 13px;
        line-height: 16px;
        color: #333333;
      }

      .basf-signUp #attributeVerification .attr ul li .attrEntry .textInput,
      .basf-signUp #attributeVerification .attr ul li .attrEntry .dropdown_single {
        font-size: 18px;
        padding: 16px 0 16px 18px;
        width: 100%;
        border: 1px solid #8f8f8f;
        border-top: 2px solid #8f8f8f;
        background: #f0f0f0;
        color: #8f8f8f;
        margin-top: 5px;
        outline: none;
      }
      
      .basf-signUp #attributeVerification .attr ul li .attrEntry.validate .error.itemLevel.show,
      .basf-signUp #attributeVerification .attr ul li .attrEntry.validate .error.itemLevel {
        color: #D20D26;
        font-size: 12px;
        position: absolute;
      }
      
      .basf-signUp #attributeVerification .attr ul li:first-child .attrEntry.validate .error.itemLevel.show,
      .basf-signUp #attributeVerification .attr ul li:nth-child(2) .attrEntry.validate .error.itemLevel.show {
        top: 48%;
      }
      
      .basf-signUp #attributeVerification .attr ul li:nth-child(3) .attrEntry.validate .error.itemLevel.show,
      .basf-signUp #attributeVerification .attr ul li:nth-child(4) .attrEntry.validate .error.itemLevel {
        top: 64.7%;
      }
      
      .basf-signUp #attributeVerification .attr ul li:nth-child(5) .attrEntry.validate .error.itemLevel.show {
        top: 81.3%;
      }
      
      .basf-signUp #attributeVerification .attr ul li:nth-child(6) .attrEntry.validate .error.itemLevel.show,
      .basf-signUp #attributeVerification .attr ul li:nth-child(7) .attrEntry.validate .error.itemLevel.show {
        top: 97.9%;
      }
      
      .basf-signUp #attributeVerification .attr ul li:nth-child(8) .attrEntry.validate .error.itemLevel.show {
        top: 114.5%;
      }
      
      .basf-signUp #attributeVerification .attr ul li:nth-child(9) .attrEntry.validate .error.itemLevel.show,
      .basf-signUp #attributeVerification .attr ul li:nth-child(10) .attrEntry.validate .error.itemLevel,
      .basf-signUp #attributeVerification .attr ul li:nth-child(11) .attrEntry.validate .error.itemLevel.show {
        top: 131.2%;
      }
      
      .basf-signUp #attributeVerification .attr ul li:last-child .attrEntry.validate .error.itemLevel.show,
      .basf-signUp #attributeVerification .attr ul li:last-child .attrEntry.validate .error.itemLevel {
        top: 147.9%;
      }
      
      .basf-signUp #attributeVerification #passwordEntryMismatch {
        font-size: 12px;
        position: absolute;
        top: 97.9%;
        left: 53.2%;
        width: 360px;
        color: #D20D26;
      }

      .basf-signUp #attributeVerification #requiredFieldMissing {
        position: absolute;
        top: 31.5%;
        font-size: 14px;
        color: #D20D26;
      }
      
      .basf-signUp #attributeVerification .buttons {
        display: flex;
        flex-direction: row-reverse;
        margin: 60px 0 150px 0;
      }

      .basf-signUp #attributeVerification .buttons #continue {
        color: #fff;
        background-color: #63af00;
        border: none;
        font-size: 16px;
        line-height: 18px;
        padding: 20px 33px;
        cursor: pointer;
        margin: 0 -16px 0 32px;
      }

      .basf-signUp #attributeVerification .buttons #cancel {
        border: none;
        background: none;
        color: #60b100;
        font-size: 16px;
        line-height: 18px;
        font-family: "Helvetica Neue Roman";
      }
      
      .basf-signUp #attributeVerification  #claimVerificationServerError {
        font-size: 14px;
        position: absolute;
        top: 21%;
        color: #D20D26;
      }

    </style>
  </head>
  <body>
    <header>
      <img
        src="https://raw.githubusercontent.com/Rraj-github/mark-basf/master/BASFo_wh100lg_3c.jpg" />
    </header>
    <div class="basf-signUp">
      <div id="api"></div>
    </div>
    
    <script>
      $(document).ready(function () {
        $("#api .intro>p").html("Create your BASF account");
        $(".buttons #cancel").html("Back");
        
        $("form#attributeVerification").attr("action", "/test");
        $("form#attributeVerification").attr("method", "post");

        $(".buttons #continue").click(function () {
          if ($("extension_UserType option:selected").text() == "User Type" || $("#state option:selected").text() == "State") {
            $("#extension_UserType").parent().find(".error").html("This information is required.");
            $("#state").parent().find(".error").html("This information is required.");
          };
        });
      });
        
        var phoneNumber = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
        var cellInput = $("#extension_CellPhone");
        $(".buttons #continue").click(function() {
          if(cellInput.val() != cellInput.val().match(phoneNumber)) {
            $("#extension_CellPhone").parent().find(".error").html("Enter number in '123-123-1234' format.");
            return false;
          };
        });
        
        $(document).on('submit','form#attributeVerification',function(e) {
          console.log(cellInput.val() != cellInput.val().match(phoneNumber));
          if(cellInput.val() != cellInput.val().match(phoneNumber)) {
            $("#extension_CellPhone").parent().find(".error").html("Enter number in '123-123-1234' format.");
            e.preventDefault();
            return false;
          };
        });
        
/*         $("#continue").click(function() {
           var emailInput = $("#email").val();
           var claimError = $("#claimVerificationServerError").text();
           claimError.prepend("sfsefsf");
         });
       });
*/
        
        function emailExistsObserver() {
          /* Select the node that will be observed for mutation */
          var emailExists = document.getElementById("claimVerificationServerError");

          var config = { attributes: true, childList: true, subtree: true };

          /* Callback function to execute when mutations are observed */
          var callback = function (mutationsList, observer) {
            /* Use traditional 'for loops' for IE 11 */
            for (let mutation of mutationsList) {
              if (mutation.type === "attributes") {
                if (mutation.attributeName == "aria-hidden") {
                  console.log(mutation.target);
                  if (mutation.target.getAttribute(mutation.attributeName) == "false") {
                    debugger;
                    var emailInput = $("#email").val();
                    var claimError = $("#claimVerificationServerError").html();
                    var res = emailInput + claimError;
                    console.log(res);
                  }
                }
              }
            }

            /* Create an observer instance linked to the callback function */
            var observer = new MutationObserver(callback);

            /* Start observing the target node for configured mutations */
            observer.observe(emailExists, config);
          };
        }

        emailExistsObserver();
    </script>
  </body>
</html>
